var Wizardwig;$.fn.wizardwig=function(t){return new $.Wizardwig(this[0],t),this},$.Wizardwig=Wizardwig=function(){function t(t,e){this.element=t,null==e&&(e={}),this.element=$(t).css("max-height","20rem"),this.$iframe=$("<iframe></iframe>").css({width:"100%",height:"100%","border-collapse":"separate",border:"1px solid rgb(204, 204, 204)","box-sizing":"content-box","box-shadow":"rgba(0, 0, 0, 0.0745098) 0px 1px 1px 0px inset","border-top-right-radius":"3px;","border-bottom-right-radius":"3px","border-bottom-left-radius":"3px","border-top-left-radius":"3px",outline:"none"}),this.$iframe.on("load",function(t){return function(){return t.window=t.$iframe[0].contentWindow,t.document=t.window.document,t.$editor=$("<div></div>").attr("contentEditable",!0).appendTo(t.document.body).on("mouseup keyup mouseout",function(){return t.update()}).on("dragenter dragover",!1).on("blur",function(){return t.selectedRange=t.getCurrentRange(),t.markSelection(!0)}),e.head&&t.addHead(e.head),t.addHead("<style>html, body, body > div {position: absolute; top:0; left 0; min-width:100%; min-height: 100%; padding: 0; margin: 0;} </style>"),setTimeout(function(){return t.update()})}}(this)).appendTo(this.element),this.element.keydown(function(t){return 13===t.keyCode?t.stopPropagation():void 0}),$(this.document).on("touchend",function(t){return function(e){var n;return n=t.getCurrentRange(),!n||n.startContainer!==n.endContainer||n.startOffset!==n.endOffset||t.$editor.is(e.target)||t.$editor.has(e.target).length>0?t.update(!0):void 0}}(this))}return t.prototype.markSelection=function(t){return this.restoreSelection(),this.document.execCommand("hiliteColor",t?"darkgrey":"transparent"),this.selectedRange=this.getCurrentRange()},t.prototype.command=function(t,e){return this.restoreSelection(),this.$editor.focus(),this.document.execCommand(t,e),this.update(),this.selectedRange=this.getCurrentRange()},t.prototype.getSelectionState=function(){var t,e,n,i,o,r,a,s;for(e={},a=this.commandStates,n=0,o=a.length;o>n;n++)t=a[n],e[t]=this.document.queryCommandState(t);for(s=this.commandValues,i=0,r=s.length;r>i;i++)t=s[i],e[t]=this.document.queryCommandValue(t);return e},t.prototype.addHead=function(t){return $("head",this.document).append(Array.isArray(t)?t.join():t)},t.prototype.update=function(t){var e,n;return e=this.getSelectionState(),n=JSON.stringify(e),this.element.css("height",this.$editor.height()),t&&(this.selectedRange=this.getCurrentRange()),this.cachedStateString!==n?(this.cachedStateString=n,e.justifyLeft||e.justifyCenter||e.justifyRight||e.justifyFull||(e.justifyLeft=!0),this.element.trigger("selectionStateChange",[e])):void 0},t.prototype.restoreSelection=function(){var t;if(t=this.window.getSelection(),this.selectedRange){try{t.removeAllRanges()}catch(e){this.document.body.createTextRange().select(),this.document.selection.empty()}return t.addRange(this.selectedRange)}},t.prototype.getCurrentRange=function(){var t;return t=this.window.getSelection(),t.getRangeAt&&t.rangeCount?t.getRangeAt(0):void 0},t.prototype.commandStates=["bold","italic","justifyCenter","justifyFull","justifyLeft","JustifyRight","strikeThrough","subscript","superscript","underline"],t.prototype.commandValues=["backColor","fontName","fontSize","foreColor"],t}();